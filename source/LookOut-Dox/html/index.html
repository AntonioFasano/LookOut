<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>LookOut: LookOut</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LookOut
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="class_look_out.html">LookOut</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="class_look_out.html">LookOut</a> is a Microsoft Outlook class macro intended to manage contacts. The main objective is to move contacts organisation from a folder structure to a category structure. The former is peculiar of Outlook, so you are locked-in. Hopefully, by using the procedures in this class, you will be able to move your contacts data to other applications, not based on a folder classification (e.g. Google contacts or Thunderbird) without losing the structure, hence the name.</p>
<p>Among the duties performed by <a class="el" href="class_look_out.html">LookOut</a> there are: the conversion of contact folders in categories; the export of entire folder trees as single-contact or multi-contact vCards, the detection and management of duplicate contacts; the inclusion of a category field when exporting as vCard.</p>
<p><a class="el" href="class_look_out.html">LookOut</a> is intended for Outlook 2010. Chances there are it will work in other versions. You don't need to be knowledgeable with VBA to use <a class="el" href="class_look_out.html">LookOut</a>.</p>
<h2>Disclaimer </h2>
<p>Despite this software helped me dramatically in my contact system migration, it is still at a beta stage: I had no time to test it thoroughly and writing sound documentation.</p>
<p>As the macros described here affect Outlook Data Files, I strongly encourage to backup them before playing with <a class="el" href="class_look_out.html">LookOut</a>. To this end I suggest that you identify the Outlook data file(s) containing critical data, close Outlook and make a copy of the files. If something goes wrong, close Outlook again and replace the data files with the back-upped copy.</p>
<p>If you want to learn more about Outlook data file read ahead the section "Outlook folder structure".</p>
<h2>Motivation </h2>
<p>I am a seasoned user of Microsoft Outlook, but I don't like it. Unfortunately I have been stuffing contacts in it for about 15 years. Migrating contacts to a different platform is not simple since they are stored in a very deep folder tree. Contact folders, and particularly nested contact folders, are a feature rather specific of Outlook. Categorizing contacts in some way is crucial to me, but every contact system has a specific classification approach (folders, categories, group, tags etc.) making it difficult to share contact data and preserving the original structure. Not to mention that, while classifying mails is always possible, many applications still have no facilities alike for contacts. Notably Thunderbird has no labelling for contacts and your choices are limited to the address book.</p>
<p>Recently I discovered a Thunderbird extension adding categories to contacts and including the possibility to search contacts by category: <a href="http://nic-nac-project.de/~kaosmos/morecols-en.html">MoreFunctionsForAddressBook</a></p>
<p>The time had come for the big switch.</p>
<h2>Outlook limitations </h2>
<p>Outlook is probably one of the most powerful PIM system and these macros are partly a consequence and an evidence of that. Outlook is also very mouse oriented. In a typical session you move back and forth from the navigation pane to the content area. If the navigation tree is very simple, few nodes and a low nesting level, then you can stand the mouse journeys, when not a keyboard addict; with a very deep structure, moving from a contact folder to a mail folder and then to the calendar etc. is very time consuming.</p>
<p>Keyboard shortcuts could help, but their design is rather weird. With CTRL-6 you visualize the contact folders in the navigation pane (yes, CTRL-6), then you'd like to scroll the tree with the arrows but, surprise, the focus is not on the folder. Even if you help yourself with the mouse and select an upper node, the focus is immediately moved away (very unnaturally). To keep the selection you have to double click, but not too fast or you will activate the rename feature.</p>
<p>Real time search could really help to get to the item you need. Here again Outlook has plenty of powerful options to search in every possible way, but you have to click way too icons and dialogs, so it's not really real time. No comparison with Gmail, where you write /Chess and you immediately get all your contacts playing your favourite game.</p>
<p>My humble opinion is that Outlook is a very mature product. When it was introduced, writing an email and searching for the recipient's details was something quite occasional in the day of a computer user, therefore the responsiveness of the interface hardly affected the overall user experience. Nowadays, since we process electronically an uncountable number of social tasks per day, the total valuable time spent in searching the proper folder with the proper item can entail a huge impact on productivity and on the level of stress at the end of the day.</p>
<p>Summing up everything you are thinking of doing will be done in Outlook, and much more, but everything will be done very slowly, and too slow for the present competition pace.</p>
<h2>Installing <a class="el" href="class_look_out.html">LookOut</a> </h2>
<h3>If you are knowledgeable with VBA</h3>
<p>Make sure you that security level are properly set in <code>Trust Centre Settings</code> then in Outlook VBA IDE import the file <code>LookOut.cls</code> and set a reference to <code>Microsoft Scripting Runtime</code> and <code>Windows Script Host Object Model</code> (the procedures <code>ExportVcf</code> and <code>MultiVcf</code> need them, other procedures don't).</p>
<p>If you like to make it more manually, you can create yourself a new class module, named <code><a class="el" href="class_look_out.html">LookOut</a></code> and copy the "VBA content" of <code>LookOut.cls</code>. This means excluding the header lines containing the class module proprieties, i.e. version attributes etc.</p>
<h3>If you are not knowledgeable with VBA</h3>
<p>Of course you are supposed to have a basic understanding of Outlook, but you don't need to have a specific knowledge of Outlook macros or the language with whom they are written, Visual Basic for Applications (VBA). Anyway this is not a tutorial on Outlook macros. If you ignore completely this subject, you might find difficult to follow these lines and prefer to read some introductory material first.</p>
<p>Bear in mind that the code, the menus and keyboard shortcuts mentioned below refer to Outlook 2010. Slight, but subtle, differences may apply to your version. If someone will give it, I will publish his/her feedback here on this regard.</p>
<p>Usual disclaimers apply, that meaning you had better to back up your valuable Outlook data before running these macros as errors may hide in the code causing unwanted side effects.</p>
<p>Let's start the setup.</p>
<p>First and foremost you have to enable macros. By default, for security reasons, macros are disabled. To enable macros, assuming they are not such, go to: </p>
<pre class="fragment">File -&gt;  Options  -&gt;  Trust Centre  -&gt;   Trust Centre Settings...  -&gt;   Macro Settings
</pre><p>Choose <code>Notification for all macros</code>. Why?</p>
<p>With this option you are notified, just once per session, of the presence of potentially risky macros. Enabling all macros without notifications adds a useless tier of risk and, of course, enabling only digitally signed macros would require a special certification procedure for macros you are going to write.</p>
<p>Identify the file <code>LookOut.cls</code>. It is on the same page/site/package from which you are reading this document.</p>
<p>Now type ALT-F11 and you will enter the VBA IDE. If not visible already, show the <code>Project Explorer</code> typing CTRL-R and the <code>Immediate Window</code> typing CTRL-G (or selecting them in the <code>View</code> menu). Therefore go to menu <code>File -&gt; Import File...</code>; a dialog windows opens, use it to import the file <code>LookOut.cls</code>. In the <code>Project Explorer</code>, you will see a new element in the <code>Class Modules</code>, named <code><a class="el" href="class_look_out.html">LookOut</a></code>.</p>
<p>In order to export the contacts (in vCard format) you need to set the so called VBA <em>references</em>. In the VBA IDE select <code>Tools-&gt;References</code>. When the dialog opens, find and check the entries <code>Microsoft Scripting Runtime</code> and <code>Windows Script Host Object Model</code> and click <code>OK</code>. This is necessary to make the procedure <code>ExportVcf</code> and <code>MultiVcf</code> work; indeed all other procedures don't need these references.</p>
<p>You are done with setup.</p>
<p>Anyway, note that you can undock, resize and close every component of the VBA IDE, much like every Windows window. As you will run macros through <code>Immediate Window</code> and read here information printed by the macros themselves, you might want adjust it a little.</p>
<h2>Outlook folder structure </h2>
<p><a class="el" href="class_look_out.html">LookOut</a> deals with Outlook folder structure. To take advantage of it you need to grasp how contacts are organised into contact folders. If you already know this, jump to the next section, else read ahead.</p>
<p>Every Outlook item, emails, notes, contacts, etc. is stored in <em>Outlook folders</em>, much like Windows files are. Outlook folders can be nested and they are stored in an <b>Outlook Store</b>. Outlook has a <em>navigation pane</em> with a <em>folder tree</em>, where you can browse the stores, their folders/subfolders and the included items. Every store corresponds to a <em>top level nodes</em> in the navigation pane; of course many users may have just one store to fit their needs. On the file system point of view, each store corresponds to a file with the extension <code>.PST</code>, defined <b>Outlook Data File</b> or sometimes <em>Personal Folder file</em>.</p>
<p>Out of the box Outlook 2010 comes with the (single) store named <code>Outlook Data File</code> associated with the file <code>USERPROFILE%\Documents\Outlook Files\Outlook.pst</code>. For many users this is all they need other may want to create new stores segregate objects with different scopes, e.g., to play with the following code, you might want to create a new store for safeguarding your data. Selecting <code>Home-&gt;New Items-&gt;More Items-&gt;Outlook Data File...</code> you can create a new <code>.PST</code> files with the associated store, where you can create, copy or move objects.</p>
<p>For macro purposes, folders in an Outlook store are denoted by a path reflecting their position in the navigation pane, similar to an ordinary file system path, that is: </p>
<pre class="fragment">"\\My Store\folder\subfolder\..."
</pre><p>Bear in mind that a store name may be different from the name of the related Outlook Data File. To learn about the file system path of a store, select it in the navigation tree, right click on <code>Data File Properties</code> and click <code>Advanced</code>. In the following dialog, the first textbox, labelled <code>Name</code>, shows the name of the data store and it is editable, that is you can change the name; the second textbox, labelled <code>Filename</code> (not editable), shows the full path of the Data File related to this store.</p>
<p>Outlook has also a notion of <b>default folder</b> for given types of items, e.g. <b>default folders for contacts</b>. This is nothing special: for most tasks, if no specific folder is given, the default one for the given items is used. There are <em>global default folders</em> and <em>per store default folders</em>. If you don't make changes, the original folders that come with the initial store after the product setup are also the default folders. Later this article will show how to use the <code>GetFolder</code> function to print the path of default contact folders.</p>
<p>When the macros presented here will ask you to input a contact folder path, often you will be allowed to give as an alternative this parameter: </p>
<pre class="fragment">DefaultFolder:=True
</pre><p>As you have guessed, in this way the global contact folder will be used.</p>
<p>Another option is to give the folder path like this: </p>
<pre class="fragment">"\\My Store"
</pre><p>In this case the default contact folder of the store named <code>My Store</code> will be used.</p>
<p>Note that paths are not case sensitive.</p>
<h2>Using <a class="el" href="class_look_out.html">LookOut</a> macros </h2>
<p>If you want you might associate VBA macros with fancy buttons and menus, but this is beyond the scope of this documentation. Here we will issue <a class="el" href="class_look_out.html">LookOut</a> commands by typing them in the <code>Immediate Window</code> of the VBA IDE.</p>
<p>A typical session consists of typing lines like these: </p>
<pre class="fragment">Set ol = new LookOut

ol.Commnad1 ...
ol.Commnad2 ...

...

Set ol = Nothing
</pre><p><code>Set ol = new <a class="el" href="class_look_out.html">LookOut</a></code> initializes the program (that is the class <code><a class="el" href="class_look_out.html">LookOut</a></code>). We then issue the commands to accomplish specific tasks and eventually we do some memory clean-up with <code>Set ol = Nothing</code>.</p>
<p>Normally you need the initialisation only once per session, that is when you open Outlook and start using <a class="el" href="class_look_out.html">LookOut</a>. Some special events, such when you click on the reset button in VBA IDE, delete the object <code>ol</code>. Therefore, should you get an <code>object required</code> error, simply issue <code>Set ol = new <a class="el" href="class_look_out.html">LookOut</a></code> again.</p>
<h3>Get Default Folders</h3>
<p>As many commands accept as input the default contact folder, you may want to learn its path with respect to Outlook tree nodes.</p>
<p>In order to print the path of the global default contact folder, type the command: </p>
<pre class="fragment">  ? ol.GlobalDefaultPath
</pre><p>You may substitute <code>?</code> with <code>Debug.Print</code>. To print the path of the default contact folder of the store named <code>My Store</code>, type the command: </p>
<pre class="fragment"> ? ol.StoreDefaultPath("\\My Store")
</pre><p>You get an error if no store with this name exists or you miss <code>\\</code>.</p>
<h3>Convert folder names in category names</h3>
<p>The main motivation to for <a class="el" href="class_look_out.html">LookOut</a> is to transform Outlook folder structure for contacts in an equivalent category structure. Categories (or labels or groups in other contact management systems) can be exported and easily understood by other applications. To accomplish this <code>Folder2Cat</code> attaches category names to contacts on the basis of the names of folders containing them.</p>
<p>If a folder is nested, the category names include also the chain of parent folders, but the name of the root contact folder will not be added as a category. Indeed every contact is in the root, so this category won't be very meaningful. So if a contact belongs to the Outlook folder <code>\\My Store\Contacts\foo\bar\etc\</code>, the three categories <code>foo, bar, etc</code> will be added to every contact in this folder and in this order (not the alphabetical one), but not <code>Contacts</code>.</p>
<p>Previous category names are preserved unless they duplicate new ones. So, if some contact in <code>\\\\My Store\Contacts\foo\bar\etc\</code> has already the categories <code>bar, baz</code>, final categorisation will be <code>baz, foo, bar, etc</code>. Similarly, if the folder path contains duplicate names, only the first occurrence will be added as a category name. Therefore, if a contact belongs to the folder <code>\\My Store\Contacts\foo\bar\foo\</code>, the two categories <code>foo, bar</code> will be added to its contacts (without name repetitions). Category comparison is not case sensitive.</p>
<p>You need to provide to <code>Folder2Cat</code> a folder path and the categorisation will be applied to all contacts belonging to the passed folder and to those in the possible nested folders. Therefore issuing:</p>
<pre class="fragment">ol.Folder2Cat "\\My Store\Contacts\foo\bar\"
</pre><p>categorisation will be applied to the folder <code>\\My Store\Contacts\foo\bar\</code> and all subfolders, if any.</p>
<p>If you want to use the global default contact folder (which supposedly contains all the contacts in your address book), issue: </p>
<pre class="fragment">ol.Folder2Cat DefaultFolder:=True
</pre><p>And, if you want to use the default contact folder of <code>\\My Store</code>: </p>
<pre class="fragment">ol.Folder2Cat "\\My Store"
</pre><p>Instead of setting a single category for each nested folder, it is possible to concatenate them via a dot, e.g. <code>cat.subcat</code>. Setting the <code>GoogleStyle:=True</code> will achieve this: </p>
<pre class="fragment">ol.Folder2Cat "\\My Store\Contacts\foo\bar\", GoogleStyle:=True
</pre><h3>Add and Remove categories</h3>
<p>If you want to add the category <code>NewCat</code> to the contacts in the folder <code>\\My Store\folder\to\categorize</code>, issue the command: </p>
<pre class="fragment">ol.AddCat `\\My Store\folder\to\process",  "NewCat"
</pre><p><code>AddCat</code> will not affect contacts in possible subfolders of <code>NewCat</code>. Besides existing category names are preserved unless they duplicate they the new one. Since the conflicting old category name will be deleted and the new one will be appended, when there are two or more category names you will just see a permutation of names, that is the old conflicting name will appear as the last category name. Given this, you will see no effect when there is just one category name like the new added one.</p>
<p>If you want to remove the category <code>Cat2Del</code> to all contacts in a the folder <code>\\My Store\folder\to\process</code>, issue the command: </p>
<pre class="fragment">ol.DelCat "\\My Store\folder\to\process", "Cat2Del"
</pre><p>The category name <code>Cat2Del</code> will be removed from all contacts in folder <code>\\My Store\folder\to\process</code>. <code>DelCat</code> will not affect contacts in possible subfolders of <code>\\My Store\folder\to\process</code>.</p>
<p>If the category asked for removing is not attached to some contacts, no warning or error will be generated and, of course, they will be unaffected by <code>Cat2Del</code>.</p>
<p>After deleting a single category from a single folder, we now turn to delete all categories from a whole contact folder tree, that is from a given folder and all its (possible) subfolders of the tree root folder.</p>
<pre class="fragment">ol.DelAllCats "\\My Store\folder\to\process"
</pre><h3>Contacts with empty names</h3>
<p>Outlook allows to store contacts without filling name fields. This can cause a problems when exporting contact data.</p>
<p>If you want to learn about possible empty name contacts in <code>\\My Store\folder\to\check</code>, use: </p>
<pre class="fragment">ol.ShowEmpty "\\My Store\folder\to\check"
</pre><p>You can fix empty names, by filling Outlook <code>LastName</code> field with <code>FileAs</code> field (always present). Issue: </p>
<pre class="fragment">ol.FillEmpty "\\My Store\folder\to\check"
</pre><p>As usual, to check/fix the global default folder, issue: </p>
<pre class="fragment">ol.ShowEmpty DefaultFolder:=True
</pre><p>and </p>
<pre class="fragment">ol.FillEmpty DefaultFolder:=True
</pre><h3>Flatten folder</h3>
<p>Once we map folders to categories, with <code>Folder2Cat</code>, there is no need to to keep contacts in separate folders. We can can put flatten them into a single folder; so the process of transforming the folder structure into the category structure is completed.</p>
<p>To flatten contacts into the tree whose parent folder is <code>\\My Store\Tree\Parent</code> into the single folder <code>\\My Store\path\to\FlatFolder</code> issue:</p>
<pre class="fragment">ol.FlattenFolderCopy "\\My Store\path\to\TreeParent", "\\My Store\path\to\FlatFolder"
</pre><p>In case you want to copy and delete contacts in <code>\\My Store\Tree\Parent</code>, issue: </p>
<pre class="fragment">ol.FlattenFolderMove  "\My Store\path\to\TreeParent", "\\My Store\path\to\FlatFolder"
</pre><h3>Find Duplicates</h3>
<p>When using Outlook folder structure you can have the same contacts stored in different folders. This is not very advisable when all contacts are in the same folder under different categories.</p>
<p><code>FindWDup</code> helps you identify duplicate contacts in a given folder tree. </p>
<pre class="fragment">ol.FindWDup  "\\My Store\folder\to\process" 
</pre><p>will find duplicates in the same folder or in different subfolders of "\\My Store\folder\to\process". The function will print the <code>FileAs</code> field and the path of duplicates in the immediate window.</p>
<p><code>FindWDup</code> considers "weak duplicates" as contacts with the same having the same <code>LastNameAndFirstName</code> or <code>FileAs</code> field. Obviously other contact fields might not be the same, so these are simply referring to the same person.</p>
<p><code>CopyUnique</code> copies only unique contacts from a given folder to another folder. </p>
<pre class="fragment">ol.CopyUnique  "\\My Store\folder\to\source" "\\My Store\folder\to\dest"
</pre><p>will copy non-duplicated (unique) contacts from <code>\\My Store\folder\to\source</code> folder <code>\\My Store\folder\to\dest</code> folder. Contacts in subfolders of <code>\\My Store\folder\to\source</code>, if any, are not included.</p>
<p><code>CopyUnique</code> considers duplicates as contacts with the same having the same <code>LastNameAndFirstName</code> or <code>FileAs</code> field and modification time.</p>
<p>It is reasonable to consider these kind of contacts total duplicate. The opposite is not true, as there can be duplicated contacts with all fields equals except modification time.</p>
<h3>The final cut</h3>
<p>After categorising folders we are able to export contacts without losing their grouping structure. We will export in <b>vCard</b> format, each exported contact will be a file with a <code>.vcf</code> extension. This format is compatible with Thunderbird and Gmail.</p>
<p>As was observed in the installation section, the actual export procedure, <code>ExportVcf</code>, needs references to <code>Microsoft Scripting Runtime</code> and <code>Windows Script Host Object Model</code>. If you missed this step, it is now a necessary one.</p>
<p>When exporting, <code>ExportVcf</code> will add Outlook contact categories (created by <code>Folder2Cat</code> and/or manually by the user) to the vCards. So, if you import the vCards, for example in Thunderbird equipped with <a href="http://nic-nac-project.de/~kaosmos/morecols-en.html">MoreFunctionsForAddressBook</a> add-in, you will find the same Outlook categories.</p>
<p>The command: </p>
<pre class="fragment">ol.ExportVcf "export\path", "\\store\folder\to\export"
</pre><p>will export as <code>.vcf</code>-files all contact contained in Outlook folder <code>\\store\folder\to\export</code> and its subfolders to the file system path <code>export\path</code>.</p>
<p>As usual: </p>
<pre class="fragment">ol.ExportVcf  "export\path", DefaultFolder:=True
</pre><p>will export from the global default contact folder.</p>
<p>The export folder path can have environment variables, e.g. <code>%USERPROFILE%\Desktop\ExportVcf</code>.</p>
<p>The name of the <code>.vcf</code>-files is given by the <code>FileAs</code> field of the contacts. Note that, when copying contacts to <code>export\path</code>, the folder structure is not kept. Therefore, if the same contact is stored in different folders, you end-up with duplicate files.</p>
<p>If a duplicate contact is found, the procedure stops exporting further contacts and skips to the next folder in the queue, if any.</p>
<p><code>ExportVcf</code> produces a vCard for each contact. Some applications, such as Gmail, require a single vCards to be combined in a single multi-contact vCard.</p>
<p>To combine the vCards in <code>export\path</code> into a single multi-contact vCard, issue: </p>
<pre class="fragment">ol.MultiVcf  "export\path", "path\to\MultivCard.vcf"
</pre><p>where <code>path\to\MultivCard.vcf</code> is the pathname of the multi-contact vCard to be created.</p>
<p><code>MultiVcf</code> does not start combining vCards, is any of them results already to be a multi-contact vCards. Possible non-vCard files the source folder are ignored. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jul 14 2013 02:10:20 for LookOut by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
